{
	"nodes": [
		{
			"id": "startNode-2dee2de5-1847-4534-ba54-28c578e2f9f8",
			"type": "startNode",
			"sourcePosition": "right",
			"position": {
				"x": 30,
				"y": 30
			},
			"deletable": false,
			"data": {
				"id": "startNode-2dee2de5-1847-4534-ba54-28c578e2f9f8",
				"type": "startNode",
				"position": {
					"x": 30,
					"y": 40
				},
				"agamaData": {
					"isTopLevelFlow": true,
					"basepath": "",
					"configParams": "{}",
					"nodeIcon": "material-symbols:line-start-square",
					"timeout": "",
					"inputs": "",
					"configs": "",
					"flowname": "co.acme.password",
					"displayName": "Password Authentication",
					"creationDate": "22/01/2025",
					"hasComment": true,
					"comment": ""
				}
			},
			"measured": {
				"width": 170,
				"height": 122
			},
			"selected": false
		},
		{
			"id": "callNode-7e1c7197-79dc-439f-931f-20f6f521a38d",
			"type": "callNode",
			"position": {
				"x": 280,
				"y": 30
			},
			"data": {
				"id": "callNode-7e1c7197-79dc-439f-931f-20f6f521a38d",
				"type": "callNode",
				"position": {
					"x": 280,
					"y": 30
				},
				"previousNodeId": "startNode-2dee2de5-1847-4534-ba54-28c578e2f9f8",
				"agamaData": {
					"javaClassName": "io.jans.as.server.service.AuthenticationService",
					"javaMethodName": "class",
					"javaVariableName": "",
					"exceptionVariableField": "",
					"callType": "Call static method",
					"arguments": [],
					"nodeIcon": "material-symbols:code",
					"nodeColor": "",
					"titleColor": "",
					"descColor": "",
					"displayName": "Get class reference",
					"hasComment": true,
					"comment": "Get authentication service class reference from the IDP",
					"asssignedVariableName": "authServiceClass"
				}
			},
			"measured": {
				"width": 170,
				"height": 122
			},
			"selected": false
		},
		{
			"id": "callNode-d13dff65-3462-4289-b47f-dd4ceeebcc04",
			"type": "callNode",
			"position": {
				"x": 530,
				"y": 30
			},
			"data": {
				"id": "callNode-d13dff65-3462-4289-b47f-dd4ceeebcc04",
				"type": "callNode",
				"position": {
					"x": 530,
					"y": 30
				},
				"previousNodeId": "callNode-7e1c7197-79dc-439f-931f-20f6f521a38d",
				"agamaData": {
					"javaClassName": "io.jans.service.cdi.util.CdiUtil",
					"javaMethodName": "bean",
					"javaVariableName": "",
					"exceptionVariableField": "",
					"callType": "Call static method",
					"arguments": [
						"authServiceClass"
					],
					"nodeIcon": "material-symbols:code",
					"nodeColor": "",
					"titleColor": "",
					"descColor": "",
					"displayName": "Get instance reference",
					"hasComment": true,
					"comment": "Get authentication service instance reference from the IDP",
					"asssignedVariableName": "authService"
				}
			},
			"measured": {
				"width": 170,
				"height": 122
			},
			"selected": false
		},
		{
			"id": "assignmentNode-fde85c9d-0937-42f4-9c0c-a2514248c540",
			"type": "assignmentNode",
			"position": {
				"x": 780,
				"y": 30
			},
			"data": {
				"id": "assignmentNode-fde85c9d-0937-42f4-9c0c-a2514248c540",
				"type": "assignmentNode",
				"position": {
					"x": 780,
					"y": 30
				},
				"previousNodeId": "callNode-d13dff65-3462-4289-b47f-dd4ceeebcc04",
				"agamaData": {
					"assignments": [
						{
							"variableTypeCheck": false,
							"assignmentExpression": "{}",
							"assignedVariableName": "authResult"
						}
					],
					"nodeIcon": "material-symbols:equal",
					"nodeColor": "",
					"titleColor": "",
					"descColor": "",
					"displayName": "Create result object",
					"hasComment": true,
					"comment": "Create empty object to store the authentication result"
				}
			},
			"measured": {
				"width": 170,
				"height": 122
			},
			"selected": false,
			"dragging": false
		},
		{
			"id": "repeatNode-5ceb1e47-bd0e-4b18-a860-2c993d02f28a",
			"type": "repeatNode",
			"position": {
				"x": 1030,
				"y": 30
			},
			"data": {
				"id": "repeatNode-5ceb1e47-bd0e-4b18-a860-2c993d02f28a",
				"type": "repeatNode",
				"position": {
					"x": 1030,
					"y": 30
				},
				"previousNodeId": "assignmentNode-fde85c9d-0937-42f4-9c0c-a2514248c540",
				"agamaData": {
					"nodeIcon": "material-symbols:event-repeat-outline-rounded",
					"maxIteration": "3",
					"maxIterationVariableName": "",
					"nodeColor": "",
					"titleColor": "",
					"descColor": "",
					"displayName": "Retry Authentication ",
					"hasComment": true,
					"comment": "Retry 3 times to get the correct username and password "
				}
			},
			"measured": {
				"width": 170,
				"height": 122
			},
			"selected": false
		},
		{
			"id": "rrfNode-ecbb78f7-18fa-4654-bdff-28220ca825c6",
			"type": "rrfNode",
			"position": {
				"x": 339.5855237410656,
				"y": 360.148529032452
			},
			"data": {
				"id": "rrfNode-ecbb78f7-18fa-4654-bdff-28220ca825c6",
				"type": "rrfNode",
				"position": {
					"x": 1280,
					"y": 280
				},
				"previousNodeId": "repeatNode-5ceb1e47-bd0e-4b18-a860-2c993d02f28a",
				"branching": "repeat",
				"agamaData": {
					"assignments": [],
					"nodeIcon": "ph:globe-simple",
					"templatePath": "login.ftlh",
					"asssignedVariableName": "creds",
					"nodeColor": "",
					"titleColor": "",
					"descColor": "",
					"displayName": "Show login page",
					"hasComment": true,
					"comment": "Load login page for username and password input",
					"arguments": [
						"authResult"
					]
				}
			},
			"measured": {
				"width": 170,
				"height": 122
			},
			"selected": false,
			"dragging": false
		},
		{
			"id": "callNode-331ce535-ffc1-4ab6-a975-621b7354429b",
			"type": "callNode",
			"position": {
				"x": 706.8011436835895,
				"y": 358.9998306943291
			},
			"data": {
				"id": "callNode-331ce535-ffc1-4ab6-a975-621b7354429b",
				"type": "callNode",
				"position": {
					"x": 1396.5855237410656,
					"y": 332.81392101044685
				},
				"previousNodeId": "rrfNode-ecbb78f7-18fa-4654-bdff-28220ca825c6",
				"agamaData": {
					"javaClassName": "",
					"javaMethodName": "authenticate",
					"javaVariableName": "authService",
					"exceptionVariableField": "",
					"callType": "Call method on instance",
					"arguments": [
						"creds.username",
						"creds.password"
					],
					"nodeIcon": "material-symbols:code",
					"nodeColor": "",
					"titleColor": "",
					"descColor": "",
					"displayName": "Validate Credentials",
					"hasComment": true,
					"comment": "Validate username and password with IDP",
					"asssignedVariableName": "authResult.success"
				}
			},
			"measured": {
				"width": 170,
				"height": 122
			},
			"selected": false,
			"dragging": false
		},
		{
			"id": "whenNode-9681f18a-f876-422a-8e4e-6ff8682194e1",
			"type": "whenNode",
			"position": {
				"x": 931.2838510738318,
				"y": 413.7208191235917
			},
			"data": {
				"id": "whenNode-9681f18a-f876-422a-8e4e-6ff8682194e1",
				"type": "whenNode",
				"position": {
					"x": 1896.5855237410656,
					"y": 332.81392101044685
				},
				"previousNodeId": "callNode-331ce535-ffc1-4ab6-a975-621b7354429b",
				"agamaData": {
					"variableField": "",
					"valueField": "",
					"conditionInputField": "",
					"conditions": [
						{
							"variable": "authResult.success",
							"operator": "is",
							"dataValue": "true",
							"combinator": "none"
						}
					],
					"nodeIcon": "ph:swap",
					"nodeColor": "",
					"titleColor": "",
					"descColor": "",
					"displayName": "",
					"hasComment": true,
					"comment": "Check if the authentication was successful "
				}
			},
			"measured": {
				"width": 110,
				"height": 59
			},
			"selected": false,
			"dragging": false
		},
		{
			"id": "finishNode-1e320497-5fa5-444f-9cee-6228f8da323a",
			"type": "finishNode",
			"position": {
				"x": 1135.1622983076957,
				"y": 455.1447049664364
			},
			"data": {
				"id": "finishNode-1e320497-5fa5-444f-9cee-6228f8da323a",
				"type": "finishNode",
				"position": {
					"x": 2051.5336765407183,
					"y": 817.6911088649499
				},
				"previousNodeId": "whenNode-9681f18a-f876-422a-8e4e-6ff8682194e1",
				"branching": "success",
				"agamaData": {
					"nodeColor": "",
					"titleColor": "",
					"descColor": "",
					"displayName": "Return Username ",
					"hasComment": true,
					"comment": "Authentication successful. Return the username.",
					"flowfilename": "",
					"returnVariable": "authResult.uid",
					"finishMode": "withVariable",
					"nodeIcon": "material-symbols:line-end-square-rounded"
				}
			},
			"measured": {
				"width": 170,
				"height": 122
			},
			"selected": true,
			"dragging": false
		},
		{
			"id": "finishNode-5483f8ed-c532-482b-a955-82dc3b3ff400",
			"type": "finishNode",
			"position": {
				"x": 1280,
				"y": 30
			},
			"data": {
				"id": "finishNode-5483f8ed-c532-482b-a955-82dc3b3ff400",
				"type": "finishNode",
				"position": {
					"x": 1280,
					"y": 30
				},
				"previousNodeId": "repeatNode-5ceb1e47-bd0e-4b18-a860-2c993d02f28a",
				"branching": "continue",
				"agamaData": {
					"nodeColor": "",
					"titleColor": "",
					"descColor": "",
					"displayName": "Max Failed Attempts Reached",
					"hasComment": true,
					"comment": "Max number of failed authentication attempts reached. return error and end the flow ",
					"flowfilename": "",
					"returnVariable": "Maximum authentication attempts reached. Authentication failed.",
					"finishMode": "withFailure",
					"nodeIcon": "material-symbols:line-end-square-rounded"
				}
			},
			"measured": {
				"width": 170,
				"height": 122
			},
			"selected": false
		}
	],
	"edges": [
		{
			"id": "startNode-2dee2de5-1847-4534-ba54-28c578e2f9f8-callNode-7e1c7197-79dc-439f-931f-20f6f521a38d",
			"type": "default",
			"source": "startNode-2dee2de5-1847-4534-ba54-28c578e2f9f8",
			"target": "callNode-7e1c7197-79dc-439f-931f-20f6f521a38d",
			"labelBgPadding": [
				8,
				4
			],
			"labelBgBorderRadius": 4,
			"label": "",
			"labelBgStyle": {
				"fill": "#009688",
				"color": "#ffffff",
				"fillOpacity": 0.7
			},
			"labelShowBg": true,
			"sourceHandle": "source_startNode-2dee2de5-1847-4534-ba54-28c578e2f9f8"
		},
		{
			"id": "callNode-7e1c7197-79dc-439f-931f-20f6f521a38d-callNode-d13dff65-3462-4289-b47f-dd4ceeebcc04",
			"type": "default",
			"source": "callNode-7e1c7197-79dc-439f-931f-20f6f521a38d",
			"target": "callNode-d13dff65-3462-4289-b47f-dd4ceeebcc04",
			"labelBgPadding": [
				8,
				4
			],
			"labelBgBorderRadius": 4,
			"label": "",
			"labelBgStyle": {
				"fill": "#009688",
				"color": "#ffffff",
				"fillOpacity": 0.7
			},
			"labelShowBg": true,
			"sourceHandle": "source_callNode-7e1c7197-79dc-439f-931f-20f6f521a38d"
		},
		{
			"id": "callNode-d13dff65-3462-4289-b47f-dd4ceeebcc04-assignmentNode-fde85c9d-0937-42f4-9c0c-a2514248c540",
			"type": "default",
			"source": "callNode-d13dff65-3462-4289-b47f-dd4ceeebcc04",
			"target": "assignmentNode-fde85c9d-0937-42f4-9c0c-a2514248c540",
			"labelBgPadding": [
				8,
				4
			],
			"labelBgBorderRadius": 4,
			"label": "",
			"labelBgStyle": {
				"fill": "#009688",
				"color": "#ffffff",
				"fillOpacity": 0.7
			},
			"labelShowBg": true,
			"sourceHandle": "source_callNode-d13dff65-3462-4289-b47f-dd4ceeebcc04"
		},
		{
			"id": "assignmentNode-fde85c9d-0937-42f4-9c0c-a2514248c540-repeatNode-5ceb1e47-bd0e-4b18-a860-2c993d02f28a",
			"type": "default",
			"source": "assignmentNode-fde85c9d-0937-42f4-9c0c-a2514248c540",
			"target": "repeatNode-5ceb1e47-bd0e-4b18-a860-2c993d02f28a",
			"labelBgPadding": [
				8,
				4
			],
			"labelBgBorderRadius": 4,
			"label": "",
			"labelBgStyle": {
				"fill": "#009688",
				"color": "#ffffff",
				"fillOpacity": 0.7
			},
			"labelShowBg": true,
			"sourceHandle": "source_assignmentNode-fde85c9d-0937-42f4-9c0c-a2514248c540"
		},
		{
			"id": "repeatNode-5ceb1e47-bd0e-4b18-a860-2c993d02f28a-rrfNode-ecbb78f7-18fa-4654-bdff-28220ca825c6",
			"type": "default",
			"source": "repeatNode-5ceb1e47-bd0e-4b18-a860-2c993d02f28a",
			"target": "rrfNode-ecbb78f7-18fa-4654-bdff-28220ca825c6",
			"labelBgPadding": [
				8,
				4
			],
			"labelBgBorderRadius": 4,
			"label": "repeat",
			"labelBgStyle": {
				"fill": "#009688",
				"color": "#ffffff",
				"fillOpacity": 0.7
			},
			"labelShowBg": true,
			"sourceHandle": "source_repeatNode-5ceb1e47-bd0e-4b18-a860-2c993d02f28a_repeat"
		},
		{
			"id": "rrfNode-ecbb78f7-18fa-4654-bdff-28220ca825c6-callNode-331ce535-ffc1-4ab6-a975-621b7354429b",
			"type": "default",
			"source": "rrfNode-ecbb78f7-18fa-4654-bdff-28220ca825c6",
			"target": "callNode-331ce535-ffc1-4ab6-a975-621b7354429b",
			"labelBgPadding": [
				8,
				4
			],
			"labelBgBorderRadius": 4,
			"label": "",
			"labelBgStyle": {
				"fill": "#009688",
				"color": "#ffffff",
				"fillOpacity": 0.7
			},
			"labelShowBg": true,
			"sourceHandle": "source_rrfNode-ecbb78f7-18fa-4654-bdff-28220ca825c6"
		},
		{
			"id": "whenNode-9681f18a-f876-422a-8e4e-6ff8682194e1-finishNode-1e320497-5fa5-444f-9cee-6228f8da323a",
			"type": "default",
			"source": "whenNode-9681f18a-f876-422a-8e4e-6ff8682194e1",
			"target": "finishNode-1e320497-5fa5-444f-9cee-6228f8da323a",
			"labelBgPadding": [
				8,
				4
			],
			"labelBgBorderRadius": 4,
			"label": "Condition met",
			"labelBgStyle": {
				"fill": "#009688",
				"color": "#ffffff",
				"fillOpacity": 0.7
			},
			"labelShowBg": true,
			"sourceHandle": "source_whenNode-9681f18a-f876-422a-8e4e-6ff8682194e1_success"
		},
		{
			"id": "repeatNode-5ceb1e47-bd0e-4b18-a860-2c993d02f28a-finishNode-5483f8ed-c532-482b-a955-82dc3b3ff400",
			"type": "default",
			"source": "repeatNode-5ceb1e47-bd0e-4b18-a860-2c993d02f28a",
			"target": "finishNode-5483f8ed-c532-482b-a955-82dc3b3ff400",
			"labelBgPadding": [
				8,
				4
			],
			"labelBgBorderRadius": 4,
			"label": "continue",
			"labelBgStyle": {
				"fill": "#009688",
				"color": "#ffffff",
				"fillOpacity": 0.7
			},
			"labelShowBg": true,
			"sourceHandle": "source_repeatNode-5ceb1e47-bd0e-4b18-a860-2c993d02f28a_continue"
		},
		{
			"source": "callNode-331ce535-ffc1-4ab6-a975-621b7354429b",
			"sourceHandle": "source_callNode-331ce535-ffc1-4ab6-a975-621b7354429b",
			"target": "whenNode-9681f18a-f876-422a-8e4e-6ff8682194e1",
			"targetHandle": "target_whenNode-9681f18a-f876-422a-8e4e-6ff8682194e1",
			"label": "",
			"labelBgPadding": [
				8,
				4
			],
			"labelBgBorderRadius": 4,
			"labelBgStyle": {
				"fill": "#009688",
				"color": "#ffffff",
				"fillOpacity": 0.7
			},
			"id": "xy-edge__callNode-331ce535-ffc1-4ab6-a975-621b7354429bsource_callNode-331ce535-ffc1-4ab6-a975-621b7354429b-whenNode-9681f18a-f876-422a-8e4e-6ff8682194e1target_whenNode-9681f18a-f876-422a-8e4e-6ff8682194e1"
		}
	],
	"viewport": {
		"x": 0,
		"y": 0,
		"zoom": 1
	}
}